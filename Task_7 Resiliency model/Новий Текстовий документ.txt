@startuml
skinparam componentStyle rectangle
skinparam cloudBackgroundColor #F0F8FF
skinparam rectangleBackgroundColor #FFFFFF
skinparam ArrowColor Black

title ðŸ›¡ Resilient Architecture â€“ "ÐœÐ°Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸ÐºÐ°: Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÐµÐ½Ð½Ñ"

actor "ÐšÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡\n(Ð’ÐµÐ± / Telegram)" as User
cloud "CloudFront / S3\n(React Frontend)" as Frontend

rectangle "ÐœÑ–ÐºÑ€Ð¾ÑÐµÑ€Ð²Ñ–ÑÐ¸ (.NET)" {
  component "Users API\n(Auth, Roles, MFA)" as Users
  component "Tests API\n(Ñ‚ÐµÑÑ‚Ð¸, ÐºÐµÑˆÑƒÐ²Ð°Ð½Ð½Ñ,\n Circuit Breaker â†’ Redis)" as Tests
  component "GeneralData API\n(Ñ‚ÐµÐ¾Ñ€Ñ–Ñ, Ñ‚ÐµÐ¼Ð¸)" as GeneralData
  component "Notation API\n(Ð½Ð¾Ñ‚Ð°Ñ‚ÐºÐ¸)" as Notation
  component "WorkTime API\n(Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ–ÑÑ‚ÑŒ, async)" as WorkTime
}

cloud "Redis Cache\nElasticache\n(Circuit Breaker, SLA 99.9%)" as Redis
database "PostgreSQL\n(RDS/Azure SQL)\nRetry + Timeout policy" as PostgreSQL
queue "SQS Queue\n(Asynchronous Messaging)" as Queue
component "Telegram Bot Service\n(Retry + Circuit Breaker)" as TelegramBot
cloud "Telegram API\n(External dependency)" as TelegramAPI
cloud "CloudWatch / AppInsights\n(Logs, Alerts, Metrics)" as Monitoring

' --- Ð—Ð²'ÑÐ·ÐºÐ¸ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð° ---
User --> Frontend : HTTPS

' --- Frontend â†’ Backend ---
Frontend --> Users
Frontend --> Tests
Frontend --> GeneralData
Frontend --> Notation
Frontend --> WorkTime

' --- Backendâ†”ï¸ DB/Cache ---
Users --> PostgreSQL
Tests --> Redis : Read-Through\n+ TTL
Tests --> PostgreSQL
GeneralData --> PostgreSQL
Notation --> PostgreSQL
WorkTime --> PostgreSQL

' --- Queue-Ð¿Ð°Ñ‚ÐµÑ€Ð½ ---
Tests --> Queue : Async Results
WorkTime --> Queue : Async Update

Queue --> TelegramBot : Consumes Events

' --- Telegram ---
TelegramBot --> TelegramAPI : Retry + Circuit Breaker
TelegramBot --> Redis : Optional cache
TelegramBot --> PostgreSQL : Progress Sync

' --- ÐœÐ¾Ð½Ñ–Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ ---
Users --> Monitoring
Tests --> Monitoring
TelegramBot --> Monitoring
Queue --> Monitoring
@enduml